"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();window.log=function(e){console.log(e)};var LgvAdmin=function(){function e(){var t=this;_classCallCheck(this,e),$(function(){t.init()})}return _createClass(e,[{key:"init",value:function(){this.$loadingPageSpin=$("#loadingPageSpin"),window.lgvAdmin=this,this.$modalConfirm=$("#modalConfirm"),this.$modalConfirmBody=this.$modalConfirm.find(".modal-body:first"),this.$modalConfirmValidate=this.$modalConfirm.find(".btn-primary:first"),$(".select2-dbPedia").each(function(e,t){new VirtualAssemblyFieldDbPedia(t)}),$(".select2-lookup").select2({ajax:{url:"/webservice/lookup",dataType:"json",delay:250,data:function(e){return{QueryString:e.term,QueryClass:$(this).attr("data-query-class")}},processResults:function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e.results[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var s=a.value;n.push({id:s.uri,text:s.label})}}catch(e){o=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}return{results:n}}}}),new LgvAdminPageTeam(this),new LgvAdminPageProfile(this),new LgvAdminPageOrga(this)}},{key:"modalConfirm",value:function(e,t){var n=this;this.$modalConfirmBody.html(e),this.$modalConfirm.modal("show"),this.$modalConfirmValidate.one("click",function(){n.$modalConfirm.modal("hide"),t()})}},{key:"pageLoadingStart",value:function(){this.$loadingPageSpin.removeClass("fadeOut").addClass("fadeIn")}},{key:"pageLoadingStop",value:function(){this.$loadingPageSpin.removeClass("fadeIn").addClass("fadeOut")}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),LgvAdminPage=function(){function e(t){_classCallCheck(this,e),this.admin=t,window.cloneWidget&&$(".form-group").on("click",".add-widget",function(){cloneWidget($(this).parent().parent().find(".sf-value-block").first().find(".ref").first())}),this.init()}return _createClass(e,[{key:"init",value:function(){}},{key:"getParameterByName",value:function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),r=n.exec(t);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},LgvAdminPageTeam=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){var e=this;_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this),$(".team-user-delete").click(function(t){t.preventDefault();var n=$(t.currentTarget).attr("rel");e.admin.modalConfirm("Êtes-vous sûr de vouloir supprimer ce compte ? Toutes les informations du profil seront perdues, et le membre n'aura plus accès au site.",function(){window.location.replace("/mon-compte/user/delete/"+n)})}),$(document.getElementById("teamManager")).find("tr").each(function(){var e=$(this),t=e.attr("rel");e.find("select[name=accessLevel]").change(function(){var e=$(this).val();window.location.replace("/mon-compte/access/change/"+t+"/"+e)})})}}]),t}(LgvAdminPage),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},LgvAdminPageProfile=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this);var e=$(".profileEditToSwitch");$(".profileEditSwitch").click(function(){e.toggle()}),this.getParameterByName("edit")&&e.toggle();var n=$("form[name=profile]");n.find('input[type="file"]').change(function(){lgvAdmin.pageLoadingStart(),n.submit()})}}]),t}(LgvAdminPage),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;if(void 0!==a)return a.call(r)},LgvAdminPageOrga=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,e),_createClass(t,[{key:"init",value:function(){var e=this;_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"init",this).call(this),$(".orga-delete").click(function(t){t.preventDefault();var n=$(t.currentTarget).attr("rel");e.admin.modalConfirm("Êtes-vous sûr de vouloir supprimer cette organisation ? Tous les membres associés vont être supprimés.",function(){window.location.replace("/mon-compte/orga/delete/"+n)})});var n=$("#organisationPictureForm");n.find('input[type="file"]').change(function(){lgvAdmin.pageLoadingStart(),n.submit()})}}]),t}(LgvAdminPage),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),VirtualAssemblyFieldDbPedia=function(){function e(t){var n=this;_classCallCheck(this,e),this.value={},this.$=$(t),this.$selector=this.$.find(".tags-selector"),this.$value=this.$.find(".tags-value"),this.$tags=this.$.find(".tags"),this.$selector.select2({width:"100%",placeholder:"Ajoutez un terme ici",ajax:{url:"http://lookup.dbpedia.org/api/search.asmx/PrefixSearch",dataType:"json",delay:250,data:function(e){return{QueryString:e.term,MaxHits:15}},processResults:function(e){var t=[];n.selectValues={};var r=!0,o=!1,i=void 0;try{for(var a,l=e.results[Symbol.iterator]();!(r=(a=l.next()).done);r=!0){var s=a.value;t.push({id:s.uri,text:s.label}),n.selectValues[s.uri]=s.label}}catch(e){o=!0,i=e}finally{try{!r&&l.return&&l.return()}finally{if(o)throw i}}return{results:t}},cache:!0}}),this.$selector.on("select2:select",function(e){n.setValue(n.$selector.val(),n.selectValues[n.$selector.val()])});var r=this.$value.val();r=r&&JSON.parse(r);var o=function(e,t){n.setValue(t,e)};Array.isArray(r)&&$.each(r,function(e,t){t&&n.getDbPediaLabel(t,o)})}return _createClass(e,[{key:"setValue",value:function(e,t){this.value[e]=t,$.ajax({}),this.fillValues()}},{key:"fillValues",value:function(){var e=this;this.$value.val(JSON.stringify(this.value)),this.$tags.empty(),$.each(this.value,function(t,n){var r=$('<span class="tag">'+n+' <a href="#" class="remove-tag glyphicon glyphicon-remove"></a></span>');r.find("a.remove-tag").click(function(n){n.preventDefault(),delete e.value[t],e.fillValues()}),e.$tags.append(r)}),this.$tags.append('<div class="clearfix"></div>'),this.$tags.toggle(!!Object.keys(this.value).length),this.$selector.val(null).trigger("change")}},{key:"getDbPediaLabel",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fr",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"http://www.w3.org/2000/01/rdf-schema#label";$.ajax({headers:{Accept:"application/json","Accept-Language":"fr"},url:e,complete:function(o){$.each(o.responseJSON[e][r],function(r,o){o.lang===n&&t(o.value,e)})}})}}]),e}();new LgvAdmin;
//# sourceMappingURL=script.min.js.map
