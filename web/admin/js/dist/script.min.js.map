{"version":3,"sources":["web/admin/js/src/class/lgvAdmin.js","web/admin/js/src/class/lgvAdminPage.js","web/admin/js/src/class/lgvAdminPageTeam.js","web/admin/js/src/class/lgvAdminPageUser.js","web/admin/js/src/class/lgvAdminPageProfile.js","web/admin/js/src/class/lgvAdminPageOrga.js","web/admin/js/src/class/lgvAdminPageComponent.js","web/admin/js/src/main.js"],"names":["window","log","m","console","LgvAdmin","_this","this","_classCallCheck","$","init","_this2","$loadingPageSpin","lgvAdmin","$modalConfirm","$modalConfirmBody","find","$modalConfirmValidate","each","index","form","$form","change","pageLoadingStart","submit","LgvAdminPageTeam","LgvAdminPageProfile","LgvAdminPageOrga","LgvAdminPageComponent","LgvAdminPageUser","message","callback","_this3","html","modal","one","removeClass","addClass","LgvAdminPage","admin","cloneWidget","on","parent","first","name","url","location","href","replace","regex","RegExp","results","exec","decodeURIComponent","_get","prototype","__proto__","Object","getPrototypeOf","call","click","e","preventDefault","userId","currentTarget","attr","modalConfirm","document","getElementById","$this","roles","val","nameRoute","$toggle","toggle","getParameterByName","uri","nameComponent","mouseover","mouseout"],"mappings":"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","file":"script.min.js","sourcesContent":["window.log = (m) => {\r\n  \"use strict\";\r\n  console.log(m);\r\n};\r\n\r\nclass LgvAdmin {\r\n  constructor() {\r\n    // Wait document loaded.\r\n    $(()=> {\r\n      this.init();\r\n    });\r\n  }\r\n\r\n  init() {\r\n    this.$loadingPageSpin = $('#loadingPageSpin');\r\n    // Save globally.\r\n    window.lgvAdmin = this;\r\n\r\n    // Define reused variables.\r\n    this.$modalConfirm = $('#modalConfirm');\r\n    this.$modalConfirmBody = this.$modalConfirm.find('.modal-body:first');\r\n    this.$modalConfirmValidate = this.$modalConfirm.find('.btn-primary:first');\r\n\r\n    // Change image field.\r\n    $('form').each((index, form) => {\r\n      let $form = $(form);\r\n      $form.find('div.formEditAvatar input[type=\"file\"]').change(() => {\r\n        // Display a nice spinner.\r\n        this.pageLoadingStart();\r\n        // Send form will reload the page.\r\n        $form.submit();\r\n      });\r\n    });\r\n\r\n    new LgvAdminPageTeam(this);\r\n    new LgvAdminPageProfile(this);\r\n    new LgvAdminPageOrga(this);\r\n    new LgvAdminPageComponent(this);\r\n    new LgvAdminPageUser(this);\r\n  }\r\n\r\n  modalConfirm(message, callback) {\r\n    this.$modalConfirmBody.html(message);\r\n    this.$modalConfirm.modal('show');\r\n    this.$modalConfirmValidate.one('click', () => {\r\n      this.$modalConfirm.modal('hide');\r\n      callback();\r\n    });\r\n  }\r\n\r\n  pageLoadingStart() {\r\n    this.$loadingPageSpin\r\n      .removeClass('fadeOut')\r\n      .addClass('fadeIn');\r\n  }\r\n\r\n  pageLoadingStop() {\r\n    this.$loadingPageSpin\r\n      .removeClass('fadeIn')\r\n      .addClass('fadeOut');\r\n  }\r\n}\r\n","class LgvAdminPage {\r\n  constructor(admin) {\r\n    this.admin = admin;\r\n\r\n    // Need wikipedia.js and formInteraction.js\r\n    if (window.cloneWidget) {\r\n      // Manage widgets duplication.\r\n      $(\".form-group\").on('click', '.add-widget', function () {\r\n        cloneWidget($(this)\r\n          .parent()\r\n          .parent()\r\n          .find('.sf-value-block')\r\n          .first()\r\n          .find('.ref')\r\n          .first())\r\n      });\r\n    }\r\n    this.init();\r\n  }\r\n\r\n  init() {}\r\n\r\n  getParameterByName(name, url) {\r\n    if (!url) {\r\n      url = window.location.href;\r\n    }\r\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\r\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\r\n      results = regex.exec(url);\r\n    if (!results) return null;\r\n    if (!results[2]) return '';\r\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\r\n  }\r\n}\r\n","class LgvAdminPageTeam extends LgvAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // On user profile, remove user button.\r\n    $('.team-user-delete').click((e) => {\r\n      // Disable default click behavior.\r\n      e.preventDefault();\r\n      let userId = $(e.currentTarget).attr('rel');\r\n      // Use custom modal for message.\r\n      this.admin.modalConfirm('Êtes-vous sûr de vouloir supprimer ce compte ? ' +\r\n        'Toutes les informations du profil seront perdues, ' +\r\n        'et le membre n\\'aura plus accès au site.', () => {\r\n        window.location.replace('/mon-compte/user/delete/' + userId);\r\n      });\r\n    });\r\n\r\n    $(document.getElementById('teamManager')).find('tr').each(function () {\r\n      let $this = $(this);\r\n      let userId = $this.attr('rel');\r\n\r\n      // Manage select changes.\r\n      $this.find('select[name=accessLevel]').change(function () {\r\n          let roles = $(this).val();\r\n          window.location.replace('/mon-compte/access/change/' + userId + '/' + roles);\r\n      });\r\n    });\r\n  }\r\n}\r\n","class LgvAdminPageUser extends LgvAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // On user profile, remove user button.\r\n    $('.user-send-email').click((e) => {\r\n      // Disable default click behavior.\r\n      e.preventDefault();\r\n      let userId = $(e.currentTarget).attr('rel');\r\n      let nameRoute = $(e.currentTarget).attr('nameRoute');\r\n      // Use custom modal for message.\r\n       window.location.replace('/user/send/' + userId +'/'+nameRoute);\r\n    });\r\n\r\n\r\n  }\r\n}\r\n","class LgvAdminPageProfile extends LgvAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // Click on edit profile button.\r\n    let $toggle = $('.profileEditToSwitch');\r\n    $('.profileEditSwitch').click(() => {\r\n      $toggle.toggle();\r\n    });\r\n\r\n    // Display form if asked.\r\n    if (this.getParameterByName('edit')) {\r\n      $toggle.toggle();\r\n    }\r\n  }\r\n}\r\n","class LgvAdminPageOrga extends LgvAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // On user profile, remove user button.\r\n    $('.orga-delete').click((e) => {\r\n      // Disable default click behavior.\r\n      e.preventDefault();\r\n      var userId = $(e.currentTarget).attr('rel');\r\n      // Use custom modal for message.\r\n      this.admin.modalConfirm('Êtes-vous sûr de vouloir supprimer cette organisation ? Tous les membres associés vont être supprimés.', () => {\r\n        window.location.replace('/mon-compte/orga/delete/' + userId);\r\n      });\r\n    });\r\n\r\n    // Change image field.\r\n    let $form = $('#organisationPictureForm');\r\n    $form.find('input[type=\"file\"]').change(()=> {\r\n        // Display a nice spinner.\r\n        lgvAdmin.pageLoadingStart();\r\n        // Send form will reload the page.\r\n        $form.submit();\r\n    });\r\n  }\r\n}\r\n","class LgvAdminPageComponent extends LgvAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // On user profile, remove user button.\r\n    $('.component-delete').click((e) => {\r\n      // Disable default click behavior.\r\n      e.preventDefault();\r\n      let uri = $(e.currentTarget).attr('rel');\r\n      let nameComponent = $(e.currentTarget).attr('name');\r\n      // Use custom modal for message.\r\n      this.admin.modalConfirm('Êtes-vous sûr de vouloir supprimer ce '+nameComponent+' ? ' +\r\n        'Toutes les informations seront perdues. ', () => {\r\n        window.location.replace('/mon-compte/component/delete?uri=' + uri+'&componentName='+nameComponent);\r\n      });\r\n    });\r\n    $('.component-new-picture').change((e) => {\r\n      e.preventDefault();\r\n      log($(e.currentTarget).val());\r\n      $(\"img[id='componentPicture']\").attr('src',$(e.currentTarget).val());\r\n    });\r\n      $(\"a[id='componentPicture']\").mouseover((e) => {\r\n          $('#componentImage').attr('class', 'form-group col-xs-12 has-success');\r\n      })\r\n      .mouseout((e) => {\r\n          $('#componentImage').attr('class', 'form-group col-xs-12');\r\n      })\r\n  }\r\n}\r\n","// It knows what to do.\r\nnew LgvAdmin();\r\n\r\n"]}