{"version":3,"sources":["web/admin/js/src/class/cartoAdmin.js","web/admin/js/src/class/cartoAdminPage.js","web/admin/js/src/class/cartoAdminPageTeam.js","web/admin/js/src/class/cartoAdminPageUser.js","web/admin/js/src/class/cartoAdminPageProfile.js","web/admin/js/src/class/cartoAdminPageOrga.js","web/admin/js/src/class/cartoAdminPageComponent.js","vendor/VirtualAssembly/SemanticFormsBundle/VirtualAssembly/SemanticFormsBundle/Resources/js/field.uri.js","vendor/VirtualAssembly/SemanticFormsBundle/VirtualAssembly/SemanticFormsBundle/Resources/js/field.dbPedia.js","vendor/VirtualAssembly/SemanticFormsBundle/VirtualAssembly/SemanticFormsBundle/Resources/js/semanticForms.js","web/admin/js/src/main.js"],"names":["window","log","m","console","CartoAdmin","_this","this","_classCallCheck","$","init","_this2","$loadingPageSpin","lgvAdmin","$modalConfirm","$modalConfirmBody","find","$modalConfirmValidate","each","index","form","$form","change","pageLoadingStart","submit","CartoAdminPageTeam","CartoAdminPageProfile","CartoAdminPageOrga","CartoAdminPageComponent","CartoAdminPageUser","message","callback","_this3","html","modal","one","removeClass","addClass","CartoAdminPage","admin","cloneWidget","on","parent","first","name","url","location","href","replace","regex","RegExp","results","exec","decodeURIComponent","_get","prototype","__proto__","Object","getPrototypeOf","call","click","e","preventDefault","userId","currentTarget","attr","modalConfirm","document","getElementById","$this","roles","val","nameRoute","$toggle","toggle","getParameterByName","autocomplete","source","requete","reponse","ajax","data","success","donnee","map","features","objet","properties","label","uri","nameComponent","mouseover","mouseout","VirtualAssemblyFieldUri","dom","value","$selector","$value","$tags","urlLookup","urlLabel","rdfType","select2","width","placeholder","dataType","delay","lookupParams","bind","processResults","lookupProcessResults","cache","setValue","selectValues","startupValue","JSON","parse","getLabelCallback","Array","isArray","key","getUriLabel","params","QueryString","term","MaxHits","items","title","push","id","text","fillValues","stringify","empty","$item","append","keys","length","trigger","complete","r","responseJSON","VirtualAssemblyFieldDbPedia","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","result","err","return","lang","arguments","propertyUri","callbackLanguage","values","acceptedLang","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","headers","Accept","Accept-Language","ucFirst","charAt","toUpperCase","slice","item"],"mappings":"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","file":"script.min.js","sourcesContent":["window.log = (m) => {\r\n  \"use strict\";\r\n  console.log(m);\r\n};\r\n\r\nclass CartoAdmin {\r\n  constructor() {\r\n    // Wait document loaded.\r\n    $(()=> {\r\n      this.init();\r\n    });\r\n  }\r\n\r\n  init() {\r\n    this.$loadingPageSpin = $('#loadingPageSpin');\r\n    // Save globally.\r\n    window.lgvAdmin = this;\r\n\r\n    // Define reused variables.\r\n    this.$modalConfirm = $('#modalConfirm');\r\n    this.$modalConfirmBody = this.$modalConfirm.find('.modal-body:first');\r\n    this.$modalConfirmValidate = this.$modalConfirm.find('.btn-primary:first');\r\n\r\n    // Change image field.\r\n    $('form').each((index, form) => {\r\n      let $form = $(form);\r\n      $form.find('div.formEditAvatar input[type=\"file\"]').change(() => {\r\n        // Display a nice spinner.\r\n        this.pageLoadingStart();\r\n        // Send form will reload the page.\r\n        $form.submit();\r\n      });\r\n    });\r\n\r\n    new CartoAdminPageTeam(this);\r\n    new CartoAdminPageProfile(this);\r\n    new CartoAdminPageOrga(this);\r\n    new CartoAdminPageComponent(this);\r\n    new CartoAdminPageUser(this);\r\n  }\r\n\r\n  modalConfirm(message, callback) {\r\n    this.$modalConfirmBody.html(message);\r\n    this.$modalConfirm.modal('show');\r\n    this.$modalConfirmValidate.one('click', () => {\r\n      this.$modalConfirm.modal('hide');\r\n      callback();\r\n    });\r\n  }\r\n\r\n  pageLoadingStart() {\r\n    this.$loadingPageSpin\r\n      .removeClass('fadeOut')\r\n      .addClass('fadeIn');\r\n  }\r\n\r\n  pageLoadingStop() {\r\n    this.$loadingPageSpin\r\n      .removeClass('fadeIn')\r\n      .addClass('fadeOut');\r\n  }\r\n}\r\n","class CartoAdminPage {\r\n  constructor(admin) {\r\n    this.admin = admin;\r\n\r\n    // Need wikipedia.js and formInteraction.js\r\n    if (window.cloneWidget) {\r\n      // Manage widgets duplication.\r\n      $(\".form-group\").on('click', '.add-widget', function () {\r\n        cloneWidget($(this)\r\n          .parent()\r\n          .parent()\r\n          .find('.sf-value-block')\r\n          .first()\r\n          .find('.ref')\r\n          .first())\r\n      });\r\n    }\r\n    this.init();\r\n  }\r\n\r\n  init() {}\r\n\r\n  getParameterByName(name, url) {\r\n    if (!url) {\r\n      url = window.location.href;\r\n    }\r\n    name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\r\n    var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\r\n      results = regex.exec(url);\r\n    if (!results) return null;\r\n    if (!results[2]) return '';\r\n    return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\r\n  }\r\n}\r\n","class CartoAdminPageTeam extends CartoAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // On user profile, remove user button.\r\n    $('.team-user-delete').click((e) => {\r\n      // Disable default click behavior.\r\n      e.preventDefault();\r\n      let userId = $(e.currentTarget).attr('rel');\r\n      // Use custom modal for message.\r\n      this.admin.modalConfirm('Êtes-vous sûr de vouloir supprimer ce compte ? ' +\r\n        'Toutes les informations du profil seront perdues, ' +\r\n        'et le membre n\\'aura plus accès au site.', () => {\r\n        window.location.replace('/mon-compte/user/delete/' + userId);\r\n      });\r\n    });\r\n\r\n    $(document.getElementById('teamManager')).find('tr').each(function () {\r\n      let $this = $(this);\r\n      let userId = $this.attr('rel');\r\n\r\n      // Manage select changes.\r\n      $this.find('select[name=accessLevel]').change(function () {\r\n          let roles = $(this).val();\r\n          window.location.replace('/mon-compte/access/change/' + userId + '/' + roles);\r\n      });\r\n    });\r\n  }\r\n}\r\n","class CartoAdminPageUser extends CartoAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // On user profile, remove user button.\r\n    $('.user-send-email').click((e) => {\r\n      // Disable default click behavior.\r\n      e.preventDefault();\r\n      let userId = $(e.currentTarget).attr('rel');\r\n      let nameRoute = $(e.currentTarget).attr('nameRoute');\r\n      // Use custom modal for message.\r\n       window.location.replace('/user/send/' + userId +'/'+nameRoute);\r\n    });\r\n\r\n\r\n  }\r\n}\r\n","class CartoAdminPageProfile extends CartoAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // Click on edit profile button.\r\n    let $toggle = $('.profileEditToSwitch');\r\n    $('.profileEditSwitch').click(() => {\r\n      $toggle.toggle();\r\n    });\r\n\r\n    // Display form if asked.\r\n    if (this.getParameterByName('edit')) {\r\n      $toggle.toggle();\r\n    }\r\n  }\r\n}\r\n","class CartoAdminPageOrga extends CartoAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // On user profile, remove user button.\r\n    $('.orga-delete').click((e) => {\r\n      // Disable default click behavior.\r\n      e.preventDefault();\r\n      var userId = $(e.currentTarget).attr('rel');\r\n      // Use custom modal for message.\r\n      this.admin.modalConfirm('Êtes-vous sûr de vouloir supprimer cette organisation ? Tous les membres associés vont être supprimés.', () => {\r\n        window.location.replace('/mon-compte/orga/delete/' + userId);\r\n      });\r\n    });\r\n\r\n    // Change image field.\r\n    let $form = $('#organisationPictureForm');\r\n    $form.find('input[type=\"file\"]').change(()=> {\r\n        // Display a nice spinner.\r\n        lgvAdmin.pageLoadingStart();\r\n        // Send form will reload the page.\r\n        $form.submit();\r\n    });\r\n      $('.lookupAdressse input').autocomplete({\r\n          source : function(requete, reponse){ // les deux arguments représentent les données nécessaires au plugin\r\n\r\n              $.ajax({\r\n\r\n                  url : 'http://api-adresse.data.gouv.fr/search/', // on appelle le script JSON\r\n                  data: 'q=' + $('.lookupAdressse input').val(),\r\n\r\n                  //dataType : 'json', // on spécifie bien que le type de données est en JSON\r\n\r\n                  success : function(donnee){\r\n                      reponse($.map(donnee.features, function(objet){\r\n                          log(objet.properties.label)\r\n                          return objet.properties.label; // on retourne cette forme de suggestion\r\n\r\n                      }));\r\n\r\n                  },\r\n              });\r\n\r\n          }\r\n      });\r\n  }\r\n}\r\n","class CartoAdminPageComponent extends CartoAdminPage {\r\n  init() {\r\n    super.init();\r\n\r\n    // On user profile, remove user button.\r\n    $('.component-delete').click((e) => {\r\n      // Disable default click behavior.\r\n      e.preventDefault();\r\n      let uri = $(e.currentTarget).attr('rel');\r\n      let nameComponent = $(e.currentTarget).attr('name');\r\n      // Use custom modal for message.\r\n      this.admin.modalConfirm('Êtes-vous sûr de vouloir supprimer ce '+nameComponent+' ? ' +\r\n        'Toutes les informations seront perdues. ', () => {\r\n        window.location.replace('/mon-compte/component/delete?uri=' + uri+'&componentName='+nameComponent);\r\n      });\r\n    });\r\n    $('.component-new-picture').change((e) => {\r\n      e.preventDefault();\r\n      log($(e.currentTarget).val());\r\n      $(\"img[id='componentPicture']\").attr('src',$(e.currentTarget).val());\r\n    });\r\n      $(\"a[id='componentPicture']\").mouseover((e) => {\r\n          $('#componentImage').attr('class', 'form-group col-xs-12 has-success');\r\n      })\r\n      .mouseout((e) => {\r\n          $('#componentImage').attr('class', 'form-group col-xs-12');\r\n      })\r\n  }\r\n}\r\n","class VirtualAssemblyFieldUri {\r\n  constructor(dom) {\r\n    this.value = {};\r\n    this.$ = $(dom);\r\n    this.$selector = this.$.find('.tags-selector');\r\n    this.$value = this.$.find('.tags-value');\r\n    this.$tags = this.$.find('.tags');\r\n    this.urlLookup = this.$.attr('data-sf-lookup');\r\n    this.urlLabel = this.$.attr('data-sf-label');\r\n    this.rdfType = this.$.attr('data-sf-rdfType');\r\n    this.$selector.select2({\r\n      width: '100%',\r\n      placeholder: \"Ajoutez un terme ici\",\r\n      ajax: {\r\n        url: this.urlLookup,\r\n        dataType: 'json',\r\n        delay: 250,\r\n        data: this.lookupParams.bind(this),\r\n        processResults: this.lookupProcessResults.bind(this)\r\n      },\r\n      cache: true\r\n    });\r\n    this.$selector.on(\"select2:select\", (e) => {\r\n      this.setValue(this.$selector.val(), this.selectValues[this.$selector.val()]);\r\n    });\r\n\r\n    // Get value.\r\n    let startupValue = this.$value.val();\r\n    // Parse it.\r\n    startupValue = startupValue && JSON.parse(startupValue);\r\n    let getLabelCallback = (label, uri) => {\r\n      this.setValue(uri, label)\r\n    };\r\n    // Load it.\r\n    if (Array.isArray(startupValue)) {\r\n      $.each(startupValue, (key, uri) => {\r\n        // Avoid all kind of empty fields.\r\n        if (uri) {\r\n          this.getUriLabel(uri, getLabelCallback);\r\n        }\r\n      });\r\n    }\r\n  }\r\n\r\n  lookupParams(params) {\r\n    return {\r\n      rdfType: this.rdfType,\r\n      QueryString: params.term,\r\n      MaxHits: 15\r\n    };\r\n  }\r\n\r\n  /**\r\n   * Expect to recieve an object with\r\n   * uri => title couples.\r\n   */\r\n  lookupProcessResults(data) {\r\n    let items = [];\r\n    this.selectValues = data;\r\n    // Transform data to select2 expected format.\r\n    $.each(this.selectValues, (uri, title) => {\r\n      items.push({\r\n        id: uri,\r\n        text: title\r\n      })\r\n    });\r\n    return {\r\n      results: items\r\n    };\r\n  }\r\n\r\n  setValue(uri, text) {\r\n    // Add to values.\r\n    this.value[uri] = text;\r\n    $.ajax({});\r\n    // Reload list.\r\n    this.fillValues();\r\n  }\r\n\r\n  fillValues() {\r\n    this.$value.val(JSON.stringify(this.value));\r\n    this.$tags.empty();\r\n    $.each(this.value, (uri, text) => {\r\n      // Build item.\r\n      let $item = $('<span class=\"tag\">' + text + ' <a href=\"#\" class=\"remove-tag glyphicon glyphicon-remove\"></a></span>')\r\n      // Click event.\r\n      $item.find('a.remove-tag').click((e) => {\r\n        e.preventDefault();\r\n        delete this.value[uri];\r\n        this.fillValues();\r\n      });\r\n      // Append.\r\n      this.$tags.append($item);\r\n    });\r\n    this.$tags.append('<div class=\"clearfix\"></div>');\r\n    // Show tags section if not empty.\r\n    this.$tags.toggle(!!Object.keys(this.value).length);\r\n    // Clear selector.\r\n    this.$selector.val(null).trigger(\"change\");\r\n  }\r\n\r\n  getUriLabel(uri, complete) {\r\n    if (uri) {\r\n      $.ajax({\r\n        url: this.urlLabel,\r\n        data: {\r\n          uri: uri\r\n        },\r\n        complete: (r) => {\r\n          this.setValue(uri, r.responseJSON.label);\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n\r\n\r\n","class VirtualAssemblyFieldDbPedia extends VirtualAssemblyFieldUri {\r\n  lookupProcessResults(data) {\r\n    let items = [];\r\n    this.selectValues = {};\r\n    for (let result of data.results) {\r\n      items.push({\r\n        id: result.uri,\r\n        text: result.label\r\n      });\r\n      this.selectValues[result.uri] = result.label;\r\n    }\r\n    return {\r\n      results: items\r\n    };\r\n  }\r\n\r\n  getUriLabel(uri, complete, lang = 'fr', propertyUri = 'http://www.w3.org/2000/01/rdf-schema#label') {\r\n    let callbackLanguage = (values, acceptedLang) => {\r\n      for (let data of values) {\r\n        // Found in asked language.\r\n        if (data.lang === acceptedLang) {\r\n          return data.value;\r\n        }\r\n      }\r\n    };\r\n    $.ajax({\r\n      headers: {\r\n        // Ensure to get JSON response.\r\n        'Accept': 'application/json',\r\n        'Accept-Language': 'fr'\r\n      },\r\n      url: uri,\r\n      complete: (r) => {\r\n        \"use strict\";\r\n        // Avoid errors.\r\n        if (r.responseJSON) {\r\n          // Get all values.\r\n          let values = r.responseJSON[uri][propertyUri];\r\n          // Return asked language || english || first found.\r\n          let value = callbackLanguage(values, lang) || callbackLanguage(values, 'en') || values[0].value;\r\n          complete(value, uri);\r\n        }\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\n\r\n","$(()=> {\r\n  \"use strict\";\r\n  let ucFirst = (text) => {\r\n    return text.charAt(0).toUpperCase() + text.slice(1);\r\n  };\r\n\r\n  $('.select2-tags').each((e, item) => {\r\n    // Build associated class.\r\n    new window['VirtualAssemblyField' + ucFirst($(item).attr('data-sf-type'))](item);\r\n  });\r\n});\r\n","// It knows what to do.\r\nnew CartoAdmin();\r\n\r\n"]}