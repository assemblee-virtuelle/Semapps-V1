{"version":3,"sources":["web/front/src/semapps-map/semapps-map.js"],"names":["Polymer","is","properties","route","type","Object","observer","pins","Array","value","attached","this","ready","semapps","map","SemAppsCarto","start","bind","OSM","L","setView","tileLayer","attribution","addTo","markers","markerClusterGroup","addLayer","pinAvailaible","awesome","http://virtual-assembly.org/pair#Person","AwesomeMarkers","icon","markerColor","http://virtual-assembly.org/pair#Organization","http://virtual-assembly.org/pair#Project","http://virtual-assembly.org/pair#Event","http://virtual-assembly.org/pair#Proposal","http://virtual-assembly.org/pair#Document","http://virtual-assembly.org/pair#DocumentType","pinShowAll","key","hasOwnProperty","pinShow","log","addPin","latitude","longitude","text","undefined","marker","bindPopup","pinShowOne","pinHideAll","pinHide","removeLayer","handleClick","e","preventDefault","scrollToContent","myRoute","goToPath","uri","window","encodeURIComponent"],"mappings":"YAAAA,UACEC,GAAI,cAEJC,YACEC,OACEC,KAAMC,OACNC,SAAU,iBAEZC,MACEH,KAAMI,MACNC,WAKJC,SAfM,WAgBJC,KAAKC,OAAQ,EAEbC,QAAQC,IAAMH,KAGdI,aAAaH,MAAMD,KAAKK,MAAMC,KAAKN,QAGrCK,MAxBM,WA0BFL,KAAKO,IAAMC,EAAEL,IAAI,WAAWM,SAAS,UAAW,mBAAoB,GACpED,EAAEE,UAAU,sDACRC,YAAa,8EACdC,MAAMZ,KAAKO,KACdP,KAAKa,QAAUL,EAAEM,qBACjBd,KAAKO,IAAIQ,SAASf,KAAKa,SACvBb,KAAKgB,iBACLhB,KAAKiB,SACDC,0CAA0CV,EAAEW,eAAeC,MACvDA,KAAM,OACNC,YAAa,SAEjBC,gDAAgDd,EAAEW,eAAeC,MAC7DA,KAAM,QACNC,YAAa,SAEjBE,2CAA2Cf,EAAEW,eAAeC,MACxDA,KAAM,aACNC,YAAa,QAEjBG,yCAAyChB,EAAEW,eAAeC,MACtDA,KAAM,WACNC,YAAa,WAEjBI,4CAA4CjB,EAAEW,eAAeC,MACzDA,KAAM,YACNC,YAAa,UAEjBK,4CAA4ClB,EAAEW,eAAeC,MACzDA,KAAM,cACNC,YAAa,UAEjBM,gDAAgDnB,EAAEW,eAAeC,MAC7DA,KAAM,UACNC,YAAa,YASvBO,WArEI,WAuEA,IAAK,GAAIC,KAAO7B,MAAKJ,KACbI,KAAKJ,KAAKkC,eAAeD,IACzB7B,KAAK+B,QAAQF,IAKzBE,QA9EI,SA8EIF,GAEA7B,KAAKJ,KAAKkC,eAAeD,IAAQ7B,KAAKgB,cAAca,IACpD7B,KAAKa,QAAQE,SAASf,KAAKJ,KAAKiC,IAChC7B,KAAKgB,cAAca,IAAO,IAG1BG,IAAI,UAAYH,EAAM,oBACtBG,IAAIhC,KAAKJ,QAOjBqC,OA7FI,SA6FGC,EAASC,EAAWN,EAAKO,EAAK3C,GAEjCO,KAAKgB,cAAca,IAAO,MACCQ,KAAvBrC,KAAKiB,QAAQxB,GACbO,KAAKJ,KAAKiC,GAAOrB,EAAE8B,QAAQJ,EAASC,IAAcf,KAAMpB,KAAKiB,QAAQxB,KAChE8C,UAAW,wBAAwBV,EAAI,SAASO,EAAK,cAE1DpC,KAAKJ,KAAKiC,GAAOrB,EAAE8B,QAAQJ,EAASC,IAC/BI,UAAU,wBAAwBV,EAAI,UAAUO,EAAK,cAG9DpC,KAAK+B,QAAQF,IAMjBW,WA9GI,SA8GOX,GAEP7B,KAAKyC,aACLzC,KAAK+B,QAAQF,IAOjBa,QAxHI,SAwHIb,GAEJ,OAAsBQ,KAAnBrC,KAAKJ,KAAKiC,KAAuB7B,KAAKgB,cAAca,GAAK,CACxD,GAAIS,GAAStC,KAAKJ,KAAKiC,EACvB7B,MAAKa,QAAQ8B,YAAYL,GACzBtC,KAAKgB,cAAca,IAAO,IAQlCY,WArII,WAuIAT,IAAI,oBACJA,IAAIhC,KAAKJ,KACT,KAAK,GAAIiC,KAAO7B,MAAKJ,KACbI,KAAKJ,KAAKkC,eAAeD,IACzB7B,KAAK0C,QAAQb,EAGrBG,KAAI,oBAIRY,YAlJI,SAkJQC,GACRA,EAAEC,iBACF5C,QAAQ6C,kBACR7C,QAAQ8C,QAAU,SAClB9C,QAAQ+C,SAAS,UACbC,IAAKC,OAAOC,mBAAmBpD,KAAKkD","file":"semapps-map.min.js","sourcesContent":["Polymer({\r\n  is: 'semapps-map',\r\n\r\n  properties: {\r\n    route: {\r\n      type: Object,\r\n      observer: '_routeChanged'\r\n    },\r\n    pins: {\r\n      type: Array,\r\n      value: []\r\n    },\r\n  },\r\n\r\n  // Wait all HTML to be loaded.\r\n  attached() {\r\n    this.ready = false;\r\n    // Global ref.\r\n    semapps.map = this;\r\n\r\n    // Wait for buildings to be loaded.\r\n    SemAppsCarto.ready(this.start.bind(this));\r\n  },\r\n\r\n  start() {\r\n    \"use strict\";\r\n      this.OSM = L.map('semapps').setView([48.862725, 2.287592000000018], 6);\r\n      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\r\n          attribution: '&copy; <a href=\"http://www.openstreetmap.org/copyright\">OpenStreetMap</a>'\r\n      }).addTo(this.OSM );\r\n      this.markers = L.markerClusterGroup();\r\n      this.OSM.addLayer(this.markers) ;\r\n      this.pinAvailaible = [];\r\n      this.awesome= {\r\n          \"http://virtual-assembly.org/pair#Person\":L.AwesomeMarkers.icon({\r\n              icon: 'user',\r\n              markerColor: 'blue'\r\n          }),\r\n          \"http://virtual-assembly.org/pair#Organization\":L.AwesomeMarkers.icon({\r\n              icon: 'tower',\r\n              markerColor: 'blue'\r\n          }),\r\n          \"http://virtual-assembly.org/pair#Project\":L.AwesomeMarkers.icon({\r\n              icon: 'screenshot',\r\n              markerColor: 'red'\r\n          }),\r\n          \"http://virtual-assembly.org/pair#Event\":L.AwesomeMarkers.icon({\r\n              icon: 'calendar',\r\n              markerColor: 'orange'\r\n          }),\r\n          \"http://virtual-assembly.org/pair#Proposal\":L.AwesomeMarkers.icon({\r\n              icon: 'info-sign',\r\n              markerColor: 'green'\r\n          }),\r\n          \"http://virtual-assembly.org/pair#Document\":L.AwesomeMarkers.icon({\r\n              icon: 'folder-open',\r\n              markerColor: 'black'\r\n          }),\r\n          \"http://virtual-assembly.org/pair#DocumentType\":L.AwesomeMarkers.icon({\r\n              icon: 'pushpin',\r\n              markerColor: 'black'\r\n          }),\r\n      }\r\n\r\n  },\r\n\r\n    /**\r\n     * affiche tous les points enregistré\r\n     */\r\n    pinShowAll() {\r\n        \"use strict\";\r\n        for (let key in this.pins) {\r\n            if (this.pins.hasOwnProperty(key)) {\r\n                this.pinShow(key);\r\n            }\r\n        }\r\n    },\r\n\r\n    pinShow(key){\r\n        \"use strict\";\r\n        if (this.pins.hasOwnProperty(key) && this.pinAvailaible[key]) {\r\n            this.markers.addLayer(this.pins[key]);\r\n            this.pinAvailaible[key] = false;\r\n\r\n        }else{\r\n            log(\"error: \" + key + \" is not a marker\")\r\n            log(this.pins)\r\n        }\r\n\r\n        //this.pins[key].addTo(this.OSM);\r\n    },\r\n\r\n\r\n    addPin(latitude,longitude, key, text,type) {\r\n        \"use strict\";\r\n        this.pinAvailaible[key] = true;\r\n        if (this.awesome[type] !== undefined) {\r\n            this.pins[key] = L.marker([latitude,longitude],  {icon: this.awesome[type]})\r\n                .bindPopup( '<a href=\"/detail?uri='+key+'\"><h5>'+text+'</h5> </a>');\r\n        }else{\r\n            this.pins[key] = L.marker([latitude,longitude])\r\n                .bindPopup('<a href=\"/detail?uri='+key+'\" ><h5>'+text+' </h5></a>');\r\n        }\r\n\r\n        this.pinShow(key);\r\n    },\r\n    /**\r\n     * affiche un point et efface les autres\r\n     * @param key -- la clé qui va être la seule affiché\r\n     */\r\n    pinShowOne(key) {\r\n        \"use strict\";\r\n        this.pinHideAll();\r\n        this.pinShow(key);\r\n    },\r\n\r\n    /**\r\n     * efface un point\r\n     * @param key -- la clé du point a ne plus afficher\r\n     */\r\n    pinHide(key) {\r\n        \"use strict\";\r\n        if(this.pins[key] !== undefined && !this.pinAvailaible[key]){\r\n            let marker = this.pins[key];\r\n            this.markers.removeLayer(marker);\r\n            this.pinAvailaible[key] = true;\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * efface tous les points\r\n     */\r\n    pinHideAll() {\r\n        \"use strict\";\r\n        log('start pinHideAll');\r\n        log(this.pins);\r\n        for (let key in this.pins){\r\n            if (this.pins.hasOwnProperty(key)) {\r\n                this.pinHide(key);\r\n            }\r\n        }\r\n        log('stop pinHideAll');\r\n\r\n    },\r\n\r\n    handleClick(e) {\r\n        e.preventDefault();\r\n        semapps.scrollToContent();\r\n        semapps.myRoute = \"detail\";\r\n        semapps.goToPath('detail', {\r\n            uri: window.encodeURIComponent(this.uri)\r\n        });\r\n    },\r\n});\r\n"]}