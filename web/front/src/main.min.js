"use strict";function _classCallCheck(e,a){if(!(e instanceof a))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,a){for(var t=0;t<a.length;t++){var n=a[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(a,t,n){return t&&e(a.prototype,t),n&&e(a,n),a}}();!function(){window.log=function(e){console.debug(e)};var e=[];window.SemAppsCarto=function(){function a(e){var t=this;_classCallCheck(this,a),log(e),window.semapps=this,this.baseUrl="/",this.myRoute=window.location.pathname.replace(/\//g,""),this.mainComponent=e,this.$window=$(window),this.detailAddress=[],this.entities={"http://virtual-assembly.org/pair#Person":{name:"Personne",plural:"Personnes",icon:"user",markerColor:"#28ccfb"},"http://virtual-assembly.org/pair#Organization":{name:"Organisation",plural:"Organisations",icon:"tower",markerColor:"#01acdd"},"http://virtual-assembly.org/pair#Project":{name:"Projet",plural:"Projets",icon:"screenshot",markerColor:"#FF4351"},"http://virtual-assembly.org/pair#Event":{name:"Evènement",plural:"Evènements",icon:"calendar",markerColor:"#FF667a"},"http://virtual-assembly.org/pair#Proposal":{name:"Proposition",plural:"Propositions",icon:"info-sign",markerColor:"#7b72e9"},"http://virtual-assembly.org/pair#Document":{name:"Document",plural:"Documents",icon:"folder-open",markerColor:"#a4de37"},"urn://semapps/thesaurus/documenttype":{name:"Type de document",plural:"Types de document",icon:"pushpin",markerColor:"#a4de37"},"urn://semapps/thesaurus/projecttype":{name:"Type de projet",plural:"Types de projets",icon:"pushpin",markerColor:"#FF4351"},"urn://semapps/thesaurus/eventtype":{name:"Type d'événement",plural:"Types d'événements",icon:"pushpin",markerColor:"#FF667a"},"urn://semapps/thesaurus/proposaltype":{name:"Type de proposition",plural:"Types de propositions",icon:"pushpin",markerColor:"#7b72e9"},"urn://semapps/thesaurus/organizationtype":{name:"Type d'organisation",plural:"Types d'organisations",icon:"pushpin",markerColor:"#01acdd"},"http://virtual-assembly.org/pair#Good":{name:"Good",plural:"Goods",icon:"gift",markerColor:"#a4de37"},"http://virtual-assembly.org/pair#Service":{name:"Service",plural:"Services",icon:"wrench",markerColor:"#a4de37"},"http://virtual-assembly.org/pair#Place":{name:"Place",plural:"Places",icon:"map-marker",markerColor:"#a4de37"},"http://assemblee-virtuelle.github.io/grands-voisins-v2/thesaurus.ttl":{name:"Type d'organisation",plural:"Types d'organisations",icon:"pushpin",markerColor:"#838e91"}};!function e(){t.ajax("webservice/parameters",function(a){a&&a.responseJSON&&a.responseJSON.no_internet?(t.baseUrl="/fake_service/",e()):t.start(a.responseJSON)})}()}return _createClass(a,[{key:"ajax",value:function(e,a){$.ajax({url:this.baseUrl+e,complete:a})}},{key:"ajaxMultiple",value:function(e,a){var t=0,n={},r=this;for(var s in e)t++,this.ajax(e[s],function(e){return function(s){t--,n[e]=JSON.parse(s.responseText),0===t&&a.call(r,n)}}(s))}},{key:"start",value:function(a){$.extend(this,a),$.each(this.entities,function(e,a){semapps.typeToName.hasOwnProperty(e)?(semapps.entities[e].nameType=semapps.typeToName[e],semapps.entities[e].type=e):(semapps.entities[e].nameType=semapps.graphToName[e],semapps.entities[e].type="http://www.w3.org/2004/02/skos/core#Concept")}),this.domSearchTextInput=this.domId("searchText"),this.isReady=!0;var t=this.mainComponent.get("route.path").split("/"),n=t.length>=2&&("rechercher"===t[1]||""===t[1]);n&&t[2]&&(this.domSearchTextInput.value=t[2]);for(var r in e)e[r]();n&&this.goSearch()}},{key:"goSearch",value:function(){var e=this.domSearchTextInput.value,a="/rechercher";a+=e?"/"+e:"",document.location.pathname===a?this.results.search(e,""):this.goToPath(a)}},{key:"scrollToContent",value:function(e){this.$window.scrollTo($("#pageContent").offset().top-150,{duration:1e3,easing:"easeOutQuad",complete:e})}},{key:"listen",value:function(e,a,t){if(!Array.isArray(a))return this.domId(e).addEventListener(a,t);for(var n in a)this.listen(e,a[n],t)}},{key:"domId",value:function(e){return document.getElementById(e)}},{key:"dom",value:function(e){return document.querySelectorAll(e)}},{key:"goToPath",value:function(e,a){this.myRoute=e,semapps.mainComponent.set("queryParams",a),semapps.mainComponent.set("route.path",e)}},{key:"imageOrFallback",value:function(e,a){return!e&&semapps.entities.hasOwnProperty(a)?"/common/images/result-no_picture-"+semapps.entities[a].nameType+".png":e}},{key:"haveName",value:function(){return""!==this.user.name}},{key:"isSuperAdmin",value:function(){return"super_admin"===this.user.access}},{key:"isAdmin",value:function(){return"admin"===this.user.access||this.isSuperAdmin()}},{key:"isMember",value:function(){return"member"===this.user.access||this.isAdmin()}},{key:"isAnonymous",value:function(){return!this.isMember()}},{key:"capitalize",value:function(e,a){return(a?e.toLowerCase():e).replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()})}},{key:"initElementGlobals",value:function(e){$.extend(e,{isAnonymous:this.isAnonymous(),isMember:this.isMember(),isAdmin:this.isAdmin(),isSuperAdmin:this.isSuperAdmin(),haveName:this.haveName()})}},{key:"realLink",value:function(e){e.preventDefault(),window.location.replace(e.currentTarget.getAttribute("href"))}},{key:"getAddressToCreatePoint",value:function(e,a,t,n){$.ajax({url:"http://api-adresse.data.gouv.fr/search/",data:"q="+e,success:function(r){semapps.map.addPin(r.features[0].geometry.coordinates[1],r.features[0].geometry.coordinates[0],n,a,t),semapps.detailAddress[e]=r}})}}]),a}(),window.SemAppsCarto.ready=function(a){window.semapps&&window.semapps.isReady?a():e.push(a)}}();
//# sourceMappingURL=main.min.js.map
