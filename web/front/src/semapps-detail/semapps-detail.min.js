"use strict";Polymer({is:"semapps-detail",properties:{id:String,title:String,description:String,queryParams:{observer:"_queryChanged"}},_queryChanged:function(e){var i=this;e&&e.uri&&SemAppsCarto.ready(function(){i.detailLoad(e.uri)})},handleBack:function(e){e.preventDefault(),semapps.goSearch()},handleEdit:function(e){e.preventDefault();var i="/",t=semapps.entities[this.child.type].nameType;switch(t){case"organization":i+="mon-compte/organization/form/"+encodeURI(encodeURIComponent(this.idOfGraph));break;case"person":i+="mon-compte/person/form";break;default:i+="mon-compte/component/"+t+"/form?uri="+this.currentComponentUri}semapps.ajax("webservice/context/change/"+encodeURI(encodeURIComponent(this.idOfGraph)),function(e){window.location.replace(i)})},attached:function(){var e=this;SemAppsCarto.ready(function(){semapps.initElementGlobals(e)})},detailLoad:function(e){var i=this;"detail"===semapps.myRoute&&(this.loading=!0,this.$.detail.style.display="none",semapps.ajax("webservice/detail?uri="+e,function(e){i.detailLoadComplete(e)}))},detailLoadComplete:function(e){if(semapps.scrollToContent(),semapps.map.pinHideAll(),e=e.responseJSON.detail||{},this.$.detail.style.display="",e.properties.image=semapps.imageOrFallback(e.properties.image,e.properties.key),e.properties.address){var i=e.properties.address[0];semapps.map.pins[e.uri]?semapps.map.pinShowOne(e.uri):semapps.getAddressToCreatePoint(i,e.title,e.properties.type[0],e.uri)}var t=document.createElement("semapps-detail-"+semapps.entities[e.properties.key].nameType.toLowerCase());this.child=t,this.id=e.id,this.isSameUri=e.uri===semapps.user.uri;var s=e.properties.graph.split(",");if(this.idOfGraph=null,this.isInGraph=!1,semapps.user.graphuri)for(var a=0,p=s.length;a<p&&!this.isInGraph;a++)semapps.user.graphuri.hasOwnProperty(s[a])&&(this.isInGraph=!0,this.idOfGraph=semapps.user.graphuri[s[a]].contextId);this.canEdit=this.isSameUri||this.isInGraph||semapps.isSuperAdmin()&&"organization"===semapps.entities[e.properties.key].nameType.toLowerCase(),t.data=e,t.parent=this,semapps.detail=this,this.currentComponentUri=e.uri;var r=document.getElementById("semapps-detail-inner");r.innerHTML="",r.appendChild(t),this.loading=!1}});
//# sourceMappingURL=semapps-detail.min.js.map
