"use strict";window.log=function(t){console.log(t)},Polymer({is:"gv-carto",ready:function(){window.gvc=this,this.$window=$(window),this.buildingSelected="all","127.0.0.1"===window.location.hostname&&window.document.body.classList.add("dev-env"),this.ajaxMultiple({buildings:"webservice/building"},this.start)},ajaxMultiple:function(t,e){var s=0,i={},r=this;for(var n in t)s++,$.ajax({url:t[n],complete:function(t){return function(n){s--,i[t]=JSON.parse(n.responseText),0===s&&e.call(r,i)}}(n)})},start:function(t){var e=this;this.buildings=t.buildings,this.domSearchTextInput=this.domId("searchText"),this.domSearchResults=this.domId("searchResults"),this.stateSet("waiting");var s=this.searchEvent.bind(this);this.listen("searchForm","submit",function(t){e.domSearchTextInput.blur(),e.scrollToSearch(),s(t)});var i;this.listen("searchText","keyup",function(){i&&window.clearTimeout(i),i=window.setTimeout(s,500)})},stateSet:function(t){if(this.stateCurrent!==t){var e=t.charAt(0).toUpperCase()+t.slice(1);if(this.stateCurrent){var s=this.stateCurrent.charAt(0).toUpperCase()+this.stateCurrent.slice(1);this["state"+s+"Exit"](),this.stateCurrent=null}this["state"+e+"Init"]()!==!1&&(this.stateCurrent=t)}},stateWaitingInit:function(){},stateWaitingExit:function(){},stateSearchInit:function(){if(!this.domSearchTextInput.value)return this.stateSet("waiting"),!1},stateSearchExit:function(){},scrollToSearch:function(){this.$window.scrollTo($("#searchTabs").offset().top-150,{duration:1e3,easing:"easeOutQuad"})},searchEvent:function(t){t&&t.preventDefault();var e=this.domSearchTextInput.value;this.search(e,{building:this.buildingSelected})},search:function(t){var e=this;arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.stateSet("search"),this.domSearchResults.innerHTML="",$("#gv-results-empty, #gv-results-error").hide(),t){var s=$("#gv-spinner"),i=function(t){s.hide(),e.renderSearchResult(t.responseJSON)};this.searchQueryLastComplete=i,s.show(),$.ajax({url:"webservice/search?t="+encodeURIComponent(t),dataType:"json",complete:function(t){i===e.searchQueryLastComplete&&i(t)}})}},renderSearchResult:function(t){if(t.error)$("#gv-results-error").show();else if(t.results.length)for(var e in t.results){var s=t.results[e],i=document.createElement("gv-results-item");i.label=s.label,i.uri=s.uri,this.domSearchResults.appendChild(i)}else $("#gv-results-empty").show()},listen:function(t,e,s){if(!Array.isArray(e))return this.domId(t).addEventListener(e,s);for(var i in e)this.listen(t,e[i],s)},domId:function(t){return document.getElementById(t)},dom:function(t){return document.querySelectorAll(t)}});
//# sourceMappingURL=gv-carto.min.js.map
