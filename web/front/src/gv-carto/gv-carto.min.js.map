{"version":3,"sources":["web/front/src/gv-carto/gv-carto.js"],"names":["Polymer","is","ready","window","log","m","console","gvc","this","$window","$","location","hostname","document","body","classList","add","ajaxMultiple","buildings","start","sources","callback","ajaxCounter","allData","self","key","ajax","url","complete","e","JSON","parse","responseText","call","data","_this","domSearchTextInput","domId","callbackSearchEvent","searchEvent","bind","listen","scrollToSearch","scrollTo","duration","easing","preventDefault","term","value","id","event","Array","isArray","addEventListener","i","getElementById","dom","selector","querySelectorAll"],"mappings":"YAAAA,UACEC,GAAI,WACJC,MAFM,WAMJC,OAAOC,IAAM,SAACC,GACZC,QAAQF,IAAIC,IAGdF,OAAOI,IAAMC,KAEbA,KAAKC,QAAUC,EAAEP,QAGgB,cAA7BA,OAAOQ,SAASC,UAClBT,OAAOU,SAASC,KAAKC,UAAUC,IAAI,WAGrCR,KAAKS,cACHC,UAAW,uBACVV,KAAKW,QAGVF,aAxBM,SAwBOG,EAASC,GAEpB,GAAIC,GAAc,EACdC,KACAC,EAAOhB,IACX,KAAK,GAAIiB,KAAOL,GACdE,IACAZ,EAAEgB,MACAC,IAAKP,EAAQK,GACbG,SAAU,SAAUH,GAClB,MAAO,UAAUI,GACfP,IACAC,EAAQE,GAAOK,KAAKC,MAAMF,EAAEG,cAER,IAAhBV,GACFD,EAASY,KAAKT,EAAMD,KAGxBE,MAKRN,MA/CM,SA+CAe,GAAM,GAAAC,GAAA3B,IAEVA,MAAKU,UAAYgB,EAAKhB,UAEtBV,KAAK4B,mBAAqB5B,KAAK6B,MAAM,aAErC,IAAIC,GAAsB9B,KAAK+B,YAAYC,KAAKhC,KAEhDA,MAAKiC,OAAO,aAAc,SAAU,SAACZ,GACnCM,EAAKO,iBACLJ,EAAoBT,KAGtBrB,KAAKiC,OAAO,aAAc,QAASH,IAGrCI,eA/DM,WAgEJlC,KAAKC,QAAQkC,SAAS,eACpBC,SAAU,IACVC,OAAQ,iBAGZN,YArEM,SAqEMV,GAEVA,GAAKA,EAAEiB,gBACP,IAAIC,GAAOvC,KAAK4B,mBAAmBY,KACnC5C,KAAI2C,IAGNN,OA5EM,SA4ECQ,EAAIC,EAAO7B,GAEhB,IAAI8B,MAAMC,QAAQF,GAMlB,MAAO1C,MAAK6B,MAAMY,GAAII,iBAAiBH,EAAO7B,EAL5C,KAAK,GAAIiC,KAAKJ,GACZ1C,KAAKiC,OAAOQ,EAAIC,EAAMI,GAAIjC,IAOhCgB,MAvFM,SAuFAY,GACJ,MAAOpC,UAAS0C,eAAeN,IAGjCO,IA3FM,SA2FFC,GACF,MAAO5C,UAAS6C,iBAAiBD","file":"gv-carto.min.js","sourcesContent":["Polymer({\n  is: 'gv-carto',\n  ready() {\n    \"use strict\";\n\n    // Devel\n    window.log = (m) => {\n      console.log(m);\n    };\n\n    window.gvc = this;\n\n    this.$window = $(window);\n\n    // Special class for dev env.\n    if (window.location.hostname === '127.0.0.1') {\n      window.document.body.classList.add('dev-env');\n    }\n\n    this.ajaxMultiple({\n      buildings: 'webservice/building'\n    }, this.start);\n  },\n\n  ajaxMultiple(sources, callback) {\n    \"use strict\";\n    var ajaxCounter = 0;\n    var allData = {};\n    var self = this;\n    for (var key in sources) {\n      ajaxCounter++;\n      $.ajax({\n        url: sources[key],\n        complete: function (key) {\n          return function (e) {\n            ajaxCounter--;\n            allData[key] = JSON.parse(e.responseText);\n            // Final callback.\n            if (ajaxCounter === 0) {\n              callback.call(self, allData);\n            }\n          }\n        }(key)\n      });\n    }\n  },\n\n  start(data) {\n    \"use strict\";\n    this.buildings = data.buildings;\n    // Shortcuts.\n    this.domSearchTextInput = this.domId('searchText');\n    // Listeners.\n    var callbackSearchEvent = this.searchEvent.bind(this);\n    // Click on submit button.\n    this.listen('searchForm', 'submit', (e) => {\n      this.scrollToSearch();\n      callbackSearchEvent(e);\n    });\n    // Type in search field.\n    this.listen('searchText', 'keyup', callbackSearchEvent);\n  },\n\n  scrollToSearch() {\n    this.$window.scrollTo('#searchTabs', {\n      duration: 1000,\n      easing: 'easeOutQuad'\n    });\n  },\n  searchEvent(e) {\n    // Event may be missing.\n    e && e.preventDefault();\n    var term = this.domSearchTextInput.value;\n    log(term);\n  },\n\n  listen(id, event, callback) {\n    // Support list of events names.\n    if (Array.isArray(event)) {\n      for (let i in event) {\n        this.listen(id, event[i], callback);\n      }\n      return;\n    }\n    return this.domId(id).addEventListener(event, callback);\n  },\n\n  domId(id) {\n    return document.getElementById(id);\n  },\n\n  dom(selector) {\n    return document.querySelectorAll(selector);\n  }\n\n});\n"]}